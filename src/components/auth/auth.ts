import { ObjectId } from 'mongoose';
import joi from 'joi';

//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////// JOI VALIDATIONS /////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

let id = joi.string().regex(/^[0-9a-fA-F]{24}$/);
let username = joi.string().min(1).max(64);
let password = joi.string().min(1).max(64);
let role = joi.string().valid('admin', 'user');

export const LoginJoi = joi.object({
    username: username.required(),
    password: password.required(),
});

export const RegisterJoi = joi.object({
    username: username.required(),
    password: password.required(),
});


//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////// TYPESCRIPT INTERFACES //////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

export interface User {
    _id: ObjectId;
    username: string;
    password: string;
    role: 'admin' | 'user';
}

export interface UserCreateDTO extends Omit<User, '_id'> {}

export interface UserLoginDTO extends Omit<User, '_id' | 'role'> {}